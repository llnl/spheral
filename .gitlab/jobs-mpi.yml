# ------------------------------------------------------------------------------
# BUILD JOBS

toss_gcc_mpi_cxxonly_init:
  extends: [.toss_shell1, .gcc_mpi_cxxonly, .init]

toss_gcc_mpi_cxxonly_tpls:
  extends: [.toss_resource1, .gcc_mpi_cxxonly, .tpls]
  needs: [toss_gcc_mpi_cxxonly_init]

toss_gcc_mpi_cxxonly_build:
  extends: [.toss_resource1, .gcc_mpi_cxxonly, .build]
  needs: [toss_gcc_mpi_cxxonly_tpls]

toss_gcc_mpi_cxxonly_cleanup:
  extends: [.toss_resource1, .gcc_mpi_cxxonly, .cleanup_dir]
  needs:
    - job: export_test
      optional: true
    - job: toss_gcc_mpi_cxxonly_build



toss_gcc_mpi_init:
  extends: [.toss_shell1, .gcc_mpi, .init]

toss_gcc_mpi_tpls:
  extends: [.toss_resource2, .gcc_mpi, .tpls]
  needs: [toss_gcc_mpi_init]

toss_gcc_mpi_build:
  extends: [.toss_resource2, .gcc_mpi, .build_and_test]
  needs: [toss_gcc_mpi_tpls]

toss_gcc_mpi_test:
  extends: [.toss_resource2, .gcc_mpi, .run_ats]
  needs: [toss_gcc_mpi_build]

toss_gcc_mpi_perf:
  extends: [.toss_shell1, .gcc_mpi, .run_perf, .perf_pr_rule]
  needs: [toss_gcc_mpi_build]

toss_gcc_mpi_cleanup:
  extends: [.toss_resource2, .gcc_mpi, .cleanup_dir, .cleanup_rule]



toss_clang_mpi_dev_build_init:
  extends: [.toss_shell1, .clang_mpi_dev_build, .init]

toss_clang_mpi_dev_build_tpls:
  extends: [.toss_resource3, .clang_mpi_dev_build, .tpls]
  needs: [toss_clang_mpi_dev_build_init]

toss_clang_mpi_dev_build_build:
  extends: [.toss_resource3, .clang_mpi_dev_build, .build_and_test]
  needs: [toss_clang_mpi_dev_build_tpls]

toss_clang_mpi_dev_build_test:
  extends: [.toss_resource3, .clang_mpi_dev_build, .run_ats]
  needs: [toss_clang_mpi_dev_build_build]

toss_clang_mpi_dev_build_perf:
  extends: [.toss_shell2, .clang_mpi_dev_build, .run_perf, .perf_pr_rule]
  needs: [toss_clang_mpi_dev_build_build]

toss_clang_mpi_dev_build_cleanup:
  extends: [.toss_resource3, .clang_mpi_dev_build, .cleanup_dir, .cleanup_rule]



#toss_oneapi_2022_1_mpi:
#  extends: [.oneapi_2022_1_mpi, .build_and_test, .toss_resource]


cray_rocm_mpi_init:
  extends: [.cray_shell1, .rocm_mpi, .init]

cray_rocm_mpi_tpls:
  extends: [.cray_resource1, .rocm_mpi, .tpls]
  needs: [cray_rocm_mpi_init]

cray_rocm_mpi_build:
  extends: [.cray_resource1, .rocm_mpi, .build_and_test]
  needs: [cray_rocm_mpi_tpls]

cray_rocm_mpi_test:
  extends: [.cray_resource1, .rocm_mpi, .run_ats]
  needs: [cray_rocm_mpi_build]

cray_rocm_mpi_perf:
  extends: [.cray_shell1, .rocm_mpi, .run_perf, .perf_pr_rule]
  needs: [cray_rocm_mpi_build]

cray_rocm_mpi_cleanup:
  extends: [.cray_resource1, .rocm_mpi, .cleanup_dir, .cleanup_rule]



cray_hip_rocm_mpi_init:
  extends: [.cray_shell1, .hip_rocm_mpi, .init]

cray_hip_rocm_mpi_tpls:
  extends: [.cray_resource2, .hip_rocm_mpi, .tpls]
  needs: [cray_hip_rocm_mpi_init]

cray_hip_rocm_mpi_build:
  extends: [.cray_resource2, .hip_rocm_mpi, .build_and_test]
  needs: [cray_hip_rocm_mpi_tpls]

cray_hip_rocm_mpi_test:
  extends: [.cray_resource2, .hip_rocm_mpi, .run_ats]
  needs: [cray_hip_rocm_mpi_build]

cray_hip_rocm_mpi_perf:
  extends: [.cray_shell2, .hip_rocm_mpi, .run_perf, .perf_pr_rule]
  needs: [cray_hip_rocm_mpi_build]

cray_hip_rocm_mpi_cleanup:
  extends: [.cray_resource2, .hip_rocm_mpi, .cleanup_dir, .cleanup_rule]
